# 壁仕様書
コードはここに落ちてます

## 概要
- 棒を押したり引いたりして遊ぶゲーム
- 壁の両側で赤チームと青チームに分かれて分かれて自分の色を沢山押し引きできたほうが勝ち
- 全部で3*4の12本棒がある
- 棒は両側で同じ色に光る
- 常に赤が4本、青が4本、白が4本光っている状態
- 押し引き判定があった場合にはその棒を白にかえて、ほかの白い棒をその色に変更する

## Arduino側(kabe2)
もうarduinoには書き込まれているはずなので強力な電源に繋げば動くと思います。(確か12Vだった気がします)
5VだとLEDが変な色に光ります(たぶん)
ハンダ付け一応しましたがどこかで断線してたりするとその後のLEDが全部死ぬので再使用するときはよく見てあげてください。

- LED24個(片面12個)ですが、全部つなげてあるので、実質信号ピンは1個のみでした。
- リードスイッチはそれぞれがついているかついていないかが知りたいので、24個別別のピンにさしてあります。
- 上の看板の色も一応ここで制御してます
- スタートボタンは押しボタンにするはずでしたが、間に合わずに的場さんが貸してくれたよくわからないボタンになりました笑
- ゲーム時間はだいたい45秒ぐらいに設定しているはずです(曖昧…)
- 音もここで制御してます、ゲームしてないときとゲームしてるとき、あと321スタートみたいなものも出してました。これはaudacityで編集しました(ダンスサークルの知恵発揮)

- ゲームモードは3種類で、待機中、開始直後、ゲーム中
- 待機中のときはLEDがランダムに光るように設定
- 開始直後は全LEDを白くしてカウントダウン開始、終了したらゲーム中のモードに切り替え
- ゲーム中はgame_main関数の処理を行う
- game_mainはfor文ですべてのLEDに対してリードスイッチのオンオフが変更になったら得点を与えてLEDの色を変えるプログラム
- リードスイッチのOn/Offはreed関数内で制御
- 押された棒を白にするのはChangeWhite関数で処理
- 他のランダムな白い棒がその色になるようにするのはChangeLED関数で処理

## Unity側(kabe)
ダウンロードしてもらってそのままarduinoとUSBでつないで、unity画面をディスプレイに映せばOK(パソコンは近くに隠しておいておく)

※注意事項
Arduinoとつなぐときにシリアル通信するのに注意(arduino側のボーレートは9600、あとポート番号の設定とか忘れなければ動くはずです。SerialHandler.csにあります)

- 大島さんに感謝です謝謝…
- ScoreManager.csのresetFlagをインスペクタ上でtrueにすると、過去の最大値がリセットされる
- changetokuten.csのなかでarduinoでserial.printされた得点をgetしています
- changemain.csで動画連続再生シーンと得点表示シーンを切り分けています

## 使うときの注意点
- Arduino側のroop関数内でゲームモードになっていないかをチェックしてるので、ゲームスタートボタンを押してから数秒待たないと始まらない
- スタートボタンをおしてはじまったらかならずスライドさせてボタンをoffにする(そうじゃないとまた終わった瞬間すぐ始まってしまうので)


## 反省
- ちっちゃい子があたまぶつけてあぶない(これは構想段階から言われていたけど)
- ゲーム説明が難しかったかも→もうすこし簡単でも良かった？
- 色盲だと色がわからないかも…
- 自分たちが最高得点だしちゃった‥(子供に夢をみさせてあげれなかった…)

